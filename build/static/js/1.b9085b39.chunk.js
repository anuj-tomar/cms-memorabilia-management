(window.webpackJsonp=window.webpackJsonp||[]).push([[1,11],{211:function(e,t,a){"use strict";a.r(t);var s=a(16),i=a(17),o=a(19),n=a(18),r=a(20),c=a(0),l=a.n(c),p=a(13),d=a(314),h=a(309),u=a(310),m=a(97),g=a(26),f=a(8),v=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(n.a)(t).call(this,e))).closeModal=function(e){e&&e.preventDefault(),a.setState({modal:null,module:null,isOpen:!1}),a.props.updateModalData({showCustomModal:!1,addon:!0})},a.scrollTo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=document.getElementById("scrollRef");t.scrollTop=t.scrollTop+e},a.scrollRef=null,a.state={modal:null,module:null,isLoaded:!1,isOpen:!1,body:""},a}return Object(r.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e,t){var s=this;if(e.modal!==this.props.modal){var i=this.props.modal;this.setState({isOpen:i.showCustomModal}),i.path?a(212)("./".concat(i.path)).then(function(e){return s.setState({module:e.default,isLoaded:!0,body:""})}).catch(function(e){console.log(e)}):i.body&&this.setState({body:i.body,module:"",isLoaded:!0})}}},{key:"render",value:function(){var e=this.state,t=e.module,a=e.modal,s=e.isLoaded,i=e.body,o=this.props.footer;return l.a.createElement(d.a,{isOpen:a.showCustomModal,className:a.className,backdrop:"static"},l.a.createElement("div",null,l.a.createElement("a",{href:"#",className:"btn-close pa",onClick:this.closeModal},l.a.createElement("span",{className:"pclose"},"+"))),l.a.createElement(h.a,{id:"scrollRef"},!s&&l.a.createElement(g.default,null),s&&t&&l.a.createElement(t,Object.assign({},a,{closeModal:this.closeModal,toastmessage:this.props.toastmessage,scrollTo:this.scrollTo})),s&&i&&i),o&&l.a.createElement(u.a,null,l.a.createElement(m.a,{color:"secondary",onClick:this.closeModal},"Cancel")))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.modal!==t.modal?{modal:e.modal}:null}}]),t}(c.Component);t.default=Object(p.b)(function(e){var t=e.page.addonmodal;return{modal:void 0===t?{showCustomModal:!1}:t}},{updateModalData:f.f})(v)},213:function(e,t,a){"use strict";a.r(t);var s=a(27),i=a(16),o=a(17),n=a(19),r=a(18),c=a(28),l=a(20),p=a(0),d=a.n(p),h=a(13),u=a(73),m=a(322),g=a.n(m),f=a(324),v=a.n(f),b=(a(340),a(30)),C=a(6),y=a(8),k=a(211),E={l:16/9,p:.75,s:1,l2:4/3,p2:.75},O=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(n.a)(this,Object(r.a)(t).call(this,e))).cropperRef=d.a.createRef(),a.onDrop=a.onDrop.bind(Object(c.a)(a)),a.onSelect=a.onSelect.bind(Object(c.a)(a)),a.RotateR=a.RotateR.bind(Object(c.a)(a)),a.cropImage=a.cropImage.bind(Object(c.a)(a)),a.zoomImage=a.zoomImage.bind(Object(c.a)(a)),a.genrateCroppedUrl=a.genrateCroppedUrl.bind(Object(c.a)(a)),a.backToOrigin=a.backToOrigin.bind(Object(c.a)(a)),a.removeImage=a.removeImage.bind(Object(c.a)(a)),a.onCrop=a.onCrop.bind(Object(c.a)(a)),a.setAspectRatio=a.setAspectRatio.bind(Object(c.a)(a)),a.changeAspectRatio=a.changeAspectRatio.bind(Object(c.a)(a)),a.toggleAlert=a.toggleAlert.bind(Object(c.a)(a)),a.setCropboxMinSize=a.setCropboxMinSize.bind(Object(c.a)(a)),a.freeCropping=a.freeCropping.bind(Object(c.a)(a)),a.setTags=a.setTags.bind(Object(c.a)(a)),a.state={r:0,list:[],selected:null,selectedName:null,selectedIndex:"",selectedType:"",iType:"",sType:"",selectedP:{},tags:"",tagsError:!1,isSaving:!1,isActive:"",alertMsg:"Uploading in progress.",buttons:["l","p","s","r","f"],minCropBoxWidth:C.g.common.w,minCropBoxHeight:C.g.common.h,aspectRatio:16/9,initialAlert:0,autoCropArea:0,isTag:!(!e.config||!e.config.isTag)&&e.config.isTag},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.buttons;this.setState({buttons:e&&e.length?e:this.state.buttons,autoCropArea:this.props.autoCropArea?this.props.autoCropArea:0}),this.onDrop(this.props.files)}},{key:"componentWillUnmount",value:function(){for(var e=this.state.list,t=e.length;t>=0;t--){var a=e[0];a&&URL.revokeObjectURL(a.preview)}}},{key:"setTags",value:function(e){this.setState({tags:e.target.value,tagsError:!e.target.value})}},{key:"onCrop",value:function(e){if(e){var t=this.state.selectedP;t.cHeight=Math.floor(e.detail.height),t.cwidth=Math.floor(e.detail.width),this.setState({selectedP:t})}}},{key:"setCropboxMinSize",value:function(e){var t,a,s=this.props.config;t=s&&s.minCropBoxSize&&s.minCropBoxSize[e]&&s.minCropBoxSize[e].w?s.minCropBoxSize[e].w:this.state.minCropBoxWidth,a=s&&s.minCropBoxSize&&s.minCropBoxSize[e]&&s.minCropBoxSize[e].h?s.minCropBoxSize[e].h:this.state.minCropBoxHeight,this.cropperRef.current.setCropBoxData({width:t,heigth:a})}},{key:"setAspectRatio",value:function(e,t){var a="l";e>t?a="p":e<t?a="l":e===t&&(a="s");var s=E[a];this.setCropboxMinSize(a),this.setState({iType:a,sType:void 0,isActive:a}),this.cropperRef.current.setAspectRatio(s)}},{key:"changeAspectRatio",value:function(e){e&&(this.setState({isActive:e}),this.setCropboxMinSize(e),this.cropperRef.current.setAspectRatio(E[e]))}},{key:"freeCropping",value:function(){this.setState({isActive:"f"}),this.cropperRef.current.setCropBoxData({width:this.state.selectedP.iwidth+"px",top:"0px",left:"0px",heigth:this.state.selectedP.iHeight+"px"}),this.cropperRef.current.setAspectRatio(NaN)}},{key:"getImageSize",value:function(e){var t=this;if(e){var a=new Image;a.src=e,a.onload=function(){var e=t.state.selectedP;e.iHeight=a.height,e.iwidth=a.width,t.props.config&&t.props.config.aspectRatio?t.changeAspectRatio(t.props.config.aspectRatio):t.setAspectRatio(e.iHeight,e.iwidth),t.setState({selectedP:e})}}}},{key:"onSelect",value:function(e,t){var a=this;if(this.state.selectedIndex!==t){this.cropperRef.current&&this.cropperRef.current.clear(),this.setState({r:0});var s,i,o=!1;if(e.thumbnail?(s=e.thumbnail,i=e.fileName,o=!0):e.file&&e.file.thumbnail&&(s=e.file.thumbnail,i=e.file.fileName,o=!0),o){this.getImageSize(s);var n=Object(b.b)(s);return n="jpg"==n?"jpeg":n,void this.setState({selected:s,selectedName:i,selectedType:"image/"+n,selectedIndex:t,tags:e.tags||"",tagsError:!1,isSaving:!1},function(){a.cropperRef.current.replace(s)})}var r=new FileReader;s=e.file,r.onload=function(){a.getImageSize(r.result)},r.onloadend=function(){a.setState({selected:r.result,selectedName:s.name,selectedType:s.type,selectedIndex:t,tags:"",tagsError:!1,isSaving:!1},function(){a.cropperRef.current.replace(r.result)})},r.readAsDataURL(s)}}},{key:"RotateR",value:function(){var e=this;this.cropperRef.current.clear(),this.cropperRef.current.replace(this.state.selected);var t=this.state.r+90;this.setState({r:360==t?0:t}),setTimeout(function(){e.cropperRef.current.rotate(t);var a,s=e.cropperRef.current.getData();a=90===s.rotate||270===s.rotate?"l"==e.state.iType?"p":"p"==e.state.iType?"l":e.state.iType:e.state.iType,e.changeAspectRatio(a)},100)}},{key:"cropImage",value:function(e){var t=this;e=e||0,setTimeout(function(){t.cropperRef.current.crop()},100)}},{key:"zoomImage",value:function(e){var t=this.cropperRef.current.getContainerData(),a=this.cropperRef.current.getImageData(),s=a.width/a.naturalWidth;e&&s>=1.5||!e&&s<=1||(s=e?s+.1:s-.1,this.cropperRef.current.zoomTo(s,{x:t.width/2,y:t.height/2}))}},{key:"onDrop",value:function(e){var t=this;if(e&&e.length){var a=e.map(function(e,t){return{imgId:t,type:"queue",file:e,preview:e.thumbnail||e.file?"":URL.createObjectURL(e),fileName:e.name,fileType:e.type,tags:e.tags||""}});this.setState({list:this.state.list.concat(a),folder:this.props.folder||"profile",folderId:this.props.id||"",tgas:a[0].tags},function(){t.onSelect(a[0],0)})}}},{key:"checkIfFilesInProgress",value:function(){var e=this.state.list.filter(function(e,t){return"saving"===e.type});return e&&e.length>0}},{key:"successCallBack",value:function(e,t){var a=this,s=this.state.list.map(function(s,i){return(e=e||{}).imgId=e.imgId||0,!e.imgId&&0!==e.imgId||i==e.imgId?t?(s.croppedSize=a.state.selectedP,s.thumbnail=e.imageUrl,s.fileName=e.imageName,s.uniqueCode=e.uniqueCode,s.type="selected",s.tags=a.state.tags,s.tempId=e.tempId,a.state.folderId||a.setState({folderId:e.tempId}),s):(s.type="error",s):s});this.setState({list:s},function(){if(a.state.selectedIndex+1>=a.state.list.length&&a.state.isSaving){if(a.checkIfFilesInProgress())return;a.backToOrigin()}})}},{key:"genrateCroppedUrl",value:function(){var e=this,t={imageName:this.state.selectedName,image:this.cropperRef.current.getCroppedCanvas().toDataURL(this.state.selectedType,.8),imgId:this.state.selectedIndex,uploadType:this.props.uploadType,token:this.props.token};this.state.folder&&(t.id=this.state.folderId||"",t.section=this.state.folder);var a=this.state.list.map(function(t,a){return a!=e.state.selectedIndex?t:(t.type=e.props.not_upload?"selected":"saving",t.thumbnail=e.cropperRef.current.getCroppedCanvas().toDataURL(e.state.selectedType,.8),t)});this.state.selectedIndex+1>=this.state.list.length&&this.setState({isSaving:!0}),this.setState({tagsError:!1,list:a},function(){if(e.state.selectedIndex+1>=e.state.list.length)e.props.not_upload&&e.backToOrigin();else{var t=e.state.selectedIndex+1;document.getElementById("thumb-"+t).click()}}),this.props.not_upload||Object(b.a)({payload:t,method:"POST",url:"".concat(this.props.apiurl?this.props.apiurl:C.d.UPLOAD)}).then(function(t){var a=t&&t.response?t.response:{};e.successCallBack(a.data,a.status)})}},{key:"removeImage",value:function(e,t){}},{key:"renderFileList",value:function(){var e=this;return this.state.list.map(function(t,a){var s={backgroundImage:"url("+(t.thumbnail?t.thumbnail:t.file.thumbnail?t.file.thumbnail:t.preview?t.preview:"")+")"};return d.a.createElement("div",{key:"_uploader_"+a},d.a.createElement("div",{className:"img-thumb  ".concat("saving"==t.type?"isSaving":""," ").concat(e.state.selectedIndex==a?"active":""),key:a},d.a.createElement("div",{onClick:function(s){return e.onSelect(t,a)},id:"thumb-".concat(a)},d.a.createElement("div",{style:s,className:"image-style"},d.a.createElement("img",{src:"./images/imagesize16_9.png",className:"w100per",alt:""}))),d.a.createElement("p",{className:"icon-fot m0"},"selected"==t.type&&d.a.createElement("i",{className:"fa fa-check-circle","aria-hidden":"true"}),"queue"==t.type&&d.a.createElement("i",{className:"fa fa-times-circle","aria-hidden":"true",onClick:function(t){return e.removeImage(t,a)}}),"error"==t.type&&d.a.createElement("i",{className:"fa fa-times-circle red","aria-hidden":"true"},"error"))))})}},{key:"toggleAlert",value:function(e){e=e||!1,this.props.updateModalData({addon:!0,showCustomModal:e,title:"",footer:!0,path:"",body:this.state.alertMsg,className:""}),this.setState({initialAlert:e?1:0})}},{key:"backToOrigin",value:function(e){if(this.props.not_upload||!this.checkIfFilesInProgress()){e&&e.preventDefault(),this.toggleAlert();var t=this.state.list.filter(function(e,t){return"selected"===e.type});this.props.onComplete(t,this.state.folderId,this.props.uploadType),this.props.onBack(!1)}else this.toggleAlert(!0)}},{key:"showNoOfImage",value:function(){return Object(C.o)()?this.state.list.length<2?1:2:this.state.list.length<4?this.state.list.length:4}},{key:"render",value:function(){var e,t=this,a=this.state,i=a.list,o=a.selected,n=a.aspectRatio,r=a.selectedP,c=a.minCropBoxWidth,l=a.minCropBoxHeight,p=a.isTag,h=a.autoCropArea,m=this.props,f=m.isSideNav,b=void 0===f||f,y=m.isBackBotton,E=void 0===y||y,O=m.isMultiple,R=void 0!==O&&O,S=m.isPopup,x={focusOnSelect:!0,dots:!1,infinite:!0,speed:500,slidesToShow:this.showNoOfImage(),slidesToScroll:1,vertical:!Object(C.o)(),verticalSwiping:!Object(C.o)(),arrows:!0};return d.a.createElement("div",{className:"container uploader"},d.a.createElement("div",{className:"photoUploader"},E&&d.a.createElement("div",{className:"title_photouploader d-flex align-items-center justify-content-between"},d.a.createElement("span",{className:"txt-kalakalphoto"},"PHOTO UPLOADER"),!S&&d.a.createElement("a",{href:"javascript:void(0)",onClick:this.backToOrigin,className:"btn-close"},d.a.createElement("span",{className:"pclose"},"+"))),!i.length&&d.a.createElement(u.a,{className:"style-upload",multiple:R,accept:"image/jpeg, image/png",onDrop:function(e,a){t.onDrop(e)}},d.a.createElement("p",{id:"file",className:"icon-plus"},"+"),d.a.createElement("p",{className:"txt-fot"},"CLICK TO UPLOAD")),d.a.createElement("div",{className:"loader-wrapper d-flex ".concat(b?"":"justify-content-center")},b&&i.length>0&&d.a.createElement("div",{className:"img-thumb-panel"},d.a.createElement("a",{href:"javascript:void(0)",className:"toparrow"}),d.a.createElement("a",{href:"javascript:void(0)",className:"downarrow"}),d.a.createElement("div",{className:"scrollouter"},d.a.createElement(v.a,x,this.renderFileList()))),o&&d.a.createElement("div",null,d.a.createElement("span",{className:"uploadtxt"},d.a.createElement("b",null,"UPLOADED SIZE-")," ",r.iwidth,"x",r.iHeight),"\xa0\xa0",d.a.createElement("span",{className:"uploadtxt"},d.a.createElement("b",null,"CURRENT SIZE-")," ",r.cwidth,"x",r.cHeight),d.a.createElement("div",{className:"panelcroparea"},d.a.createElement(g.a,{ref:this.cropperRef,className:"cropper",dragMode:"move",viewMode:1,aspectRatio:n,autoCropArea:h,strict:!1,responsive:!0,restore:!0,background:!1,autoCrop:!1,guides:!1,movable:!0,zoomable:!1,zoomOnTouch:!1,zoomOnWheel:!1,center:!0,highlight:!0,toggleDragModeOnDblclick:!1,minCropBoxWidth:c,minCropBoxHeight:l,minContainerWidth:c,minContainerHeight:l,crop:this.onCrop,ready:this.cropImage}),d.a.createElement("p",{className:"crop-txt"},"Please Crop Your Image To Save"),d.a.createElement("div",{className:"text-center btn-cropper-section d-flex"},d.a.createElement("a",{href:"javascript:void(0)",className:"".concat("f"==this.state.isActive?"active":""," ").concat(-1==this.state.buttons.indexOf("f")?"disabledlink":""),onClick:this.freeCropping},"As Is"),d.a.createElement("a",{href:"javascript:void(0)",className:"".concat("l"==this.state.isActive?"active":""," ").concat(-1==this.state.buttons.indexOf("l")?"disabledlink":""),onClick:function(e){return t.changeAspectRatio("l")}},"Landscape"),d.a.createElement("a",{href:"javascript:void(0)",className:"".concat("p"==this.state.isActive?"active":""," ").concat(-1==this.state.buttons.indexOf("p")?"disabledlink":""),onClick:function(e){return t.changeAspectRatio("p")}},"Portrait"),d.a.createElement("a",{href:"javascript:void(0)",className:"".concat("s"==this.state.isActive?"active":""," ").concat(-1==this.state.buttons.indexOf("s")?"disabledlink":""),onClick:function(e){return t.changeAspectRatio("s")}},"Square"),d.a.createElement("a",{href:"javascript:void(0)",className:"".concat(-1==this.state.buttons.indexOf("r")?"disabledlink":""),onClick:this.RotateR},"Rotate")),d.a.createElement("div",{className:"mt20 upload-tag d-flex justify-content-between"},d.a.createElement("div",null,p&&d.a.createElement("div",{className:"upload-textbox d-flex"},d.a.createElement("input",(e={type:"text",className:"form_control_",placeholder:"Type"},Object(s.a)(e,"placeholder","Tag this photo, seperate tags by comma"),Object(s.a)(e,"value",this.state.tags),Object(s.a)(e,"name","tags"),Object(s.a)(e,"onChange",this.setTags),e)),d.a.createElement("a",{href:" javascript:void(0) ",className:"btn tag-btn w100"},"TAG")),this.state.tagsError&&!1),d.a.createElement("div",null,S&&d.a.createElement("a",{href:"javascript:void(0)",className:"btn savebtn w150 mr10",onClick:this.backToOrigin},"CANCEL"),d.a.createElement("a",{href:"javascript:void(0)",className:"".concat(this.state.isSaving&&this.state.list.length==this.state.selectedIndex+1?"inactiveBtn saving-loader btndisabled":""," btn savebtn w150"),onClick:this.genrateCroppedUrl},this.state.list.length==this.state.selectedIndex+1?"SAVE":"SAVE AND NEXT")))))),d.a.createElement(k.default,{toastmessage:this.props.toastmessage})))}}]),t}(p.Component);t.default=Object(h.b)(function(e){return{token:e.auth.token}},{updateModalData:y.f})(O)},340:function(e,t,a){}}]);
//# sourceMappingURL=1.b9085b39.chunk.js.map